<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pogodynka</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300&display=swap');
        body{
            background-color: rgb(18, 71, 123);
            font-family: 'Montserrat'; 
            color: aliceblue;
            text-decoration: none;
        }
        .btnContainer {
            display: space-between;
            font-family: 'Montserrat';
            color: aliceblue;
            text-decoration: none;
            width: 100%;   
        }
        .pruba {
            display: flex;  
            text-decoration: none; 
            cursor: pointer;    
        }
        .weather{
            background-color: antiquewhite;
            opacity: 0.5;
            border-radius: 15px;
            display: grid 1 2 3;
            color: beige;
        }
        
        .weather p{
            color: white;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="logo">LOGO</div>
        <div class="btnContainer">
            <ul class="pruba"></ul>
        </div>
    </div>
    <div class="weather">
        <!-- toten -->
        <ul class="todayClass"></ul>
    </div>
    </div>
    </div>
    <script>
        const ulList = document.querySelector('.todayClass')
        const pruba = document.querySelector('.pruba')
        const dropDownBtn = document.querySelector('.btnLocation')
        
        const  geoObj = {};
        function success(pos) {
                const crd = pos.coords;
                let baselongitude = crd.longitude
                let baselatiude = crd.latitude
                geoObj.longitude = baselongitude.toFixed(0)
                geoObj.latitude = baselatiude.toFixed(0)
                
                
            }
        navigator.geolocation.getCurrentPosition(success)
        //////////////////////?????????????////////////////
        console.log(geoObj)
        
        function getCurrentData() {
            fetch('https://www.wowapi.pl/pogoda/miasta')
                .then(response => response.json())
                .then(function (data) {
                    console.log(data)
                    getList(data)
                    getGeoFromHubertsApi(data)
                })
        }
       
        function getGeoFromHubertsApi(data,geoObj){
                const{ longitude, latitude} = geoObj
                for(const key of data){
                const {szerokość, długość} = key.geo;
                let miastoO = key.nazwa;
                const apiLong = szerokość;
                const apiLati = długość;
                const apiLongitude = apiLong.toFixed(0);  
                const apiLatitude = apiLati.toFixed(0);
                    if(apiLongitude == longitude && apiLatitude == latitude){
                        //let miastoO = this.nazwa;
                        console.log("this" )
                    }else{
                        console.log('nic z tego')
                    }
                console.log(apiLatitude,apiLongitude ,miastoO) 
            }
        }   
        ////////////////longitude od huberta/////////////
        getCurrentData()
        let city;
        function getList(data) {
            for (const key of data) {
                let city = key.nazwa;
                const li = document.createElement('li');
                li.innerHTML = `<a class='cityTag'>${city}</a>`;
                li.style.listStyle = 'none';
                li.style.textDecoration = 'none';
                li.className = 'cityClass';
                li.addEventListener('click', function (e) {
                    if (e.target) {
                        this.innerHTML = city;
                        let cityName = city;
                        getCurrentWeather(cityName)
                        //console.log(cityName)
                    } else {
                        return
                    }
                });
                pruba.append(li);
            }
        }
        function getCurrentWeather(cityName) {
            fetch('https://www.wowapi.pl/pogoda/prognoza?miasto=' + cityName)
                .then(response => response.json())
                .then(function (currentWeather) {
                    console.log(currentWeather)
                    if (currentWeather) {
                        displayCurrentWeather(currentWeather, cityName)
                    } else {
                        return console.error('404 there is no of the current wether response');
                    }
                })
        }
        function displayCurrentWeather(currentWeather, cityName) {
            const { ikonka, opis, temperatura, wiatrKierunek, wiatrKierunekSłownie, wiatrPrędkość, wschódSłońca, zachmurzenie, zachódSłońca } = currentWeather.teraz
            //console.log(getWeather, temperatura + opis + wschódSłońca + wiatrPrędkość + wiatrKierunek + zachódSłońca + zachmurzenie + opis)
            const liDispalyTodayWeather = document.createElement('div')
            liDispalyTodayWeather.innerHTML =
                `<h2>Pogoda Teraz<span> ${cityName}</span></h2>
                <img class='ikonkaClass' src='./ikonki/${ikonka}.png' alt='icon' width='200' height='200'/><p>${opis}</p><p>${zachmurzenie}</p>
                <p>temperatura</p><p class='currentTempClass'>${temperatura}</p>
                <p class='windClassParagraph'>prędkość wiatru</p> <p class='windClass'>${wiatrPrędkość}</p>
                <p>kierunek wiatru</p><p class='windDirClass'>${wiatrKierunekSłownie}</p><p>${wiatrKierunek}</p>
                <p>Wschód słońca</p><p>${wschódSłońca}</p><p>zachód słońca<p>${zachódSłońca}</p>`
            liDispalyTodayWeather.className = 'todayWeatherClass'
            ulList.appendChild(liDispalyTodayWeather)
        }
          ///TODAY/////////////////////////////////////////////////
    </script>
</body>

</html>